# Linux简介

## Linux系统特点

单用户：一个用户，在登录计算机（操作系统），只能允许同时登录一个用户

单任务：一个任务，允许用户同时进行的操作任务数量

多用户：多个用户，在登录计算机（操作系统），允许同时登录多个用户进行操作

多任务：多个任务，允许用户同时进行多个操作人任务

+ Windows属于，单用户，多任务

+ Linux属于，多用户，多任务

## 虚拟机安装

弹出虚拟网卡安装点安装

要查看适配器（网络设置）中有没有两个虚拟网卡（以太网最下面标了VMware）

VirtualBox有一个



**VM：**

新建好虚拟机后装系统前：指定镜像：编辑虚拟机设置或CD/DVD选中镜像

+ **Ctrl+Alt**：**释放鼠标**

+ **有可能会报错vcpu-0**：电脑没有开启CPU虚拟化，需要在BIOS中修改
  主机名不要修改，网卡要进行配置，勾选自动连接

+ 关于**Kdump**：当内存大于1G的时候才可以正常安装，是用于记录系统崩溃的日志信息的一个存储机制。

+ VirtualBox的鼠标解放：必须用右边的Ctrl+Alt



**Shell打开后**

```
用户名@主机名 当前目录 $ 

#表示身份识别符，用root登录显示#，用普通用户登录显示$
```

【黑马，VM12Pro秘钥：5A02H-AU243-TZJ49-GTC7K-3C61N】

## 关机指令
1. `shutdown -h now`（正常关机）
2. `half`（关闭内存）
3. `init 0`

VMware提供快照来进行短期备份（开机状态菜单），克隆来长期备份（关机状态下右键虚拟机名称，相当于复制了一份，新建了另一个虚拟机）

### 重要的目录：

```
/bin
binary，含义是二进制。存储的都是二进制文件

/dev
存放外接设备，例如U盘，其他的光盘等。该目录中的外接设备需要挂载后使用

/etc
存储配置文件。

/home
除了root用户以外的家目录，类似windows下的User

/proc
process，进程。该目录存储的是Linux运行时候的进程

/root
root用户的家目录

/sbin
super binary，存放一些二进制文件，必须有super权限的用户才能执行

/tmp
temporary，系统运行时产生的临时文件

/usr
存放用户自己安装的软件

/var
存放程序/系统的日志文件的目录

/mnt
当外接设备需要挂载的时候，就需要挂载到mnt目录下
```

# Linux的基本指令


## 基础指令

### 1. ls指令 list、

```
ls [options] [path]
```

**用法1：`$ls`**

列出当前工作目录下的所有文件/文件夹的名称

**用法2：`$ls path`**

相对路径：

`./` ：当前目录
`../` ：上一级目录

绝对路径

`/` ： 根目录下

**用法3：`$ls options path`**

列出指定路径下的文件/文件夹的名称，并以指定的格式进行显示

常见的语法：

```
$ ls -l 路径
$ ls -la 路径

选项解释：
-l：表示list，标识以详细列表的形式进行展示
-a：表示显示所有的文件/文件夹（包含了隐藏文件/文件夹）

内容：
第一列：权限和权限信息；第一列的第一个字符表示文档的类型，其中“-”表示该行对应的文档类型为文件，“d”表示文档类型为文件夹
```

+ 在Linux中隐藏文档都是以“.”开头

**用法4： `$ls -lh 路径`**

含义：列出指定路径下的所有文件/文件夹的名称，以列表的形式并且在显示文档大小的时候以可读性较高的形式显示

文件夹大小都会显示4k

### 2. pwd命令

用法： `$pwd`

print working directory，打印当前工作目录

### 3. cd命令

change directory，改变目录，切换目录

作用：用于切换当前的工作目录

语法： `$cd 路径`

在Linux中有一个特殊的符号“~，表示当前用户的家目录。

### 4. mkdir指令

make directory，创建目录

**语法1**：`$mkdir 路径`【路径，可以是文件夹名称（创建在当前目录下）也可以是包含名称的一个完整路径】

注意：ls列出的结果颜色说明：其中蓝色的表示文件夹，黑色的表示文件，绿色的其权限为拥有所有权限。

**语法2**：`$mkdir -p 路径`

含义：当一次性创建多层不存在的目录的时候，添加-p参数，否则会报错

**语法3**：`$mkdir 路径1 路径2 路径3...`

含义：表示一次性创建多个目录

### 5. touch指令

作用：创建文件

语法：`$touch 文件路径`【路径可以是直接的文件名也可以是路径】

可以同时创建多个文件，在文件名中间加空格

### 6. cp指令

copy，复制

作用：复制文件/文件夹到指定的文职

语法：`$cp 被复制的文档路径 文档被复制到的路径`【可以顺便改名

注意：Linux在复制过程中是可以重新对新位置的文件进行重命名的，但是如果不是必须的需求，则建议保持前后名称一致。

复制文件夹需要加“-r”：表示递归复制，否则目录将被忽略

### 7. mv指令

move，移动，剪切

语法：`$mv 需要移动的文档路径 需要保存的位置路径`

【可以用于重命名】

不改名字可以直接不写文件名【试一试这个

移动文件夹直接mv就行，不需要加参数

### 8. rm指令

remove，移除、删除

作用：移除/删除文档

语法：`$rm 选项 需要移除的文档路径`

选项：
```
-f  ：force，强制删除，不提示是否删除
-r  ： 表示递归
```
在删除的时候如果不带选项，会提示是否删除，需要输入"y/yes"或”n/no“，按下回车

如果在删除的时候不想频繁的确认，可以添加`-f`

需要删除目录的时候需要做递归删除，并且一般也不需要进行删除确认询问，所以删除目录一般用`-rf`选项

可以删除多个文档，空格隔开

`*`：通配符，`Linux*`表示只要以Linux开头，后续字符则不管

### 9. vim命令

指令：vim （vim是一款文本编辑器）

语法：`$vim 文件的路径`

作用：打开一个文件（可以不存在，也可以存在）

退出：`:q`【shift+： ？

### 10. 输出重定向

一般命令的输出都会显示在终端中，有些时候需要将一些命令的执行结果想要保存到文件中进行后续的分析/统计，则这时候需要使用到输出重定向技术。

`>`：覆盖输出，会覆盖掉原先的文件内容

`>>`：追加输出，不会覆盖原始文件内容，会在原始内容末尾继续添加

语法：`$正常执行的指令 >/>> 文件的路径`

注意：文件可以不存在，不存在则新建

### 11. cat指令

**作用1**：cat有直接打开一个文件的功能。

语法1：`$cat 文件的路径`

**作用2**：cat还可以对文件进行合并【相当于连续打开了3个文件，合并是输出重定向的功能】

语法2：`$cat 待合并的文件路径1 待合并的文件路径2 ... 文件路径n > 合并之后的文件路径`

## 进阶指令

### 1. df指令

作用：查看磁盘空间

语法：`$df -h`

`-h`表示以可读性较高的形式展示大小

### 2. free指令

作用：查看内存使用情况

语法：`$free -m`

`-m`表示以Mb为单位查看

看剩余内存的时候看-/+ buffers/cache行

buffers和cached是已经被分配但是未使用的内存

Swap：用于临时内存，当系统真实内存不够用到时候可以临时使用磁盘空间来充当内存

### 3.head指令

作用：查看一个文件的前n行，如果不指定n，则默认显示前10行

语法：`$head -n 文件路径`

### 4.tail指令

**作用1**：查看一个文件的末n行，如果不指定n，则默认显示后10行

语法：`$tail -n 文件路径`

**作用2**：可以通过tail指令查看一个文件的动态变化（末尾变化）【变化的内容不能是用户手动增加的】

语法：`$tail -f 文件路径`

该命令一般用于查看系统的日志。

### 5.less指令

作用：查看文件，以较少的内容进行输出，按下辅助功能键【数字+回车（跳到指定行）、空格键（翻页）、上下方向键、回车（向上一行，和下方向键一样）】查看更多

语法：`$less 需要查看的文件路径`

在退出的时候按q

### 6.wc指令

作用：统计文件内容信息（包含行数、单词数、字节数）

语法：`$wc -lwc 需要统计的文件路径`

```
-l：表示lines，行数
-w：表示words，单词数【依照空格来判断单词的数量】
-c：表示bytes，字节数
不带参数就默认-lwc，-l使用的比较多
```

### 7. date指令

作用：表示操作时间日期（读取【下面的+，表示读取的固定格式】、设置）

**语法1**：`$date`

输出的形式：`2018年 03月 24日 星期六 15:54:25 CST`

`UCT CST：当地时间 GMT`

**语法2**：`$date +%F`  （等价于`$date "+%Y-%m-%d"`)

输出形式：`2018-03-24`

**语法3**：`$date "+%F %T"`（引号单双均可，表示让`%F`与`%T`连接起来作为一个整体）

等价操作`$date "+%Y-%m-%d %H:%M:%S"`

输出形式：`2018-03-24 13:20:20`

**语法4**：获取之前或之后的某个时间（备份）
`$date -d "-1 day" "+%Y-%m-%d %H:%M:%S"`输出一天前的时间

符号的可选值：`+`（之后）或者`-`（之前）
单位的可选值：`day`（天）、`month`（月）、`year`（年）【单位可以用复数s】

```
%F：表示完整的年月日
%T：表示完整的时分秒
%Y：表示四位年份
%m：表示两位月份（带前导0）
%d：表示日期（带前导0）
%H：表示小时（带前导0）
%M：表示分钟（带前导0）
%S：表示秒数（带前导0）
```

### 8. cal指令

calendar作用：用来操作日历的

**语法1**：`$cal`

直接输出当前月份的日历

等价于`$cal -1`

**语法2**：`$cal -3`

表示输出上个月+本月+下个月的日历

**语法3**：`$cal -y 年份`

表示输出某一年份的日历

```
-s ：日历每周从周日开始显示
-m：日历每周从周一开始显示
```

### 9. clear/Ctrl + L指令

作用：清除终端中已经存在的信息（但是往上滚还可以看到……）

语法：`clear`    或者快捷键：`Ctrl`+`L`

需要注意的是，该命令并不是真的清除了之前的信息，而是把之前的信息的隐藏到了最上面，通过滚动条继续查看以前的信息

【在windows的cmd中`cls`（clean screen）会真的清掉】

### 10.管道

管道符：`|`

作用：管道一般可以用于“过滤”、"特殊"、“扩展处理”。

语法：管道不能单独使用，必须需要配合别的指令来一起使用，主要是辅助作用。

+ 过滤：
`$ls ./ |grep y`
查看当前目录下包含“y”字母的文档名称
以管道为分界线，把管道前的输出作为后面指令的输入

+ 特殊：
`$cat 路径|less`
通过管道实现less的等价效果

+ 扩展处理：
`$ls 目录| wc -l`
统计目录下文档的总个数【-w的话如果文件名中间有空格会统计错误】

## 高级指令

### 1. hostname指令

作用：操作服务器的主机名（**读取**、设置）

设置是临时的，一般不用这个方法

语法1：`$hostname`

含义：表示输出完整的主机名

语法2：`$hostname -f`

含义：输出当前主机名的FQDN（Fully Qualified Domain Name全限定**域名**）

### 2. id指令

作用：查看一个用户的一些基本信息（包含用户id，用户组id，附加组id...），该指令如果不指定用户则默认当前用户。

语法1：`$id`

语法2：`$id 用户名`

### 3. whoami指令

作用：显示当前登录的用户名

语法：`whoima`

一般用于shell脚本，用于获取当前操作的用户名方便记录日志

### 4. ps -ef指令

作用：主要是查看服务器的进程信息

选项含义：
```
-e：等价于“-A”，表示列出全部的进程
-f：显示全部的列
```
>UID：User ID该进程执行的用户id
>PID：Process ID进程id
>PPID：Parent Process ID该进程的父级进程id，如果一个程序的父级进程找不到，该程序的进程称之为僵尸进程
>C：CPU的占用率，其形式是百分数
>STIME：进程的启动时间
>TTY：终端设备，发起该进程的设备识别符号，如果显示“？”则表示该进程并不是由终端设备发起
>TIME：进程的执行时间
>CMD：该进程的名称或者对应的路径  

`$ps -ef | grep 进程名称`

在ps结果中过滤出想要查看的进程的状态

gnome-panel：gnome桌面

### 5. top指令

作用：查看服务器的进程占的资源

语法：
  进入命令：`$top`  （动态显示）
  退出命令：按下`q`键
>**表头含义**
>PID：进程id
>USER：该进程对应的用户
>PR：优先级
>NI：nice value优先级，负表示高优先级，正表示低优先级
>VIRT：虚拟内存
>RES：常驻内存
>SHR：共享内存
>
>>假如一个进程启动的时候申请了500MB，实际使用了300MB，那么此时的虚拟内存为500MB，常驻内存为300MB，常驻内存可能还包含该进程对其他进程的调用开销，为共享内存
>>计算一个进程实际使用的内存 = 常驻内存（RES） - 共享内存(SHR)
>
>S：表示进程的状态（Sleeping，其中S表示睡眠，R表示运行）
>%CPU：表示CPU的占用百分比
>%MEM：表示内存的占用百分比
>TIME+：执行的时间
>COMMAND：进程的名称或者路径

在运行top的时候，可以按下方便的快捷键：

M：表示将结果按照内存（MEM）从高到低进行降序排列

P：将结果按照CPU使用率从高到低进行降序排列

1：当服务器拥有多个CPU的时候可以使用“1”快捷键来切换是否展示各个CPU的详细信息

### 6. du -sh指令

作用：查看目录的真实大小

语法：`$du -sh 目录路径`

选项含义：
```
-s：summaries，只显示汇总的大小
-h：表示以较高可读性的形式进行显示
```

### 7. find指令

作用：用于查找文件（其参数非常多），可以查找到隐藏文件

语法：`$find 路径范围 选项 选项的值`

选项：
```
-name，按照文档名称进行搜索（支持模糊搜索）
-type，按照文档的类型进行搜索，后跟空格f或d
文档类型：“-”表示文件（在使用find的时候要使用f），“d”表示文件夹
```

### 8. service指令

作用：用于控制一些软件的服务启动/停止/重启

语法：`$service 服务名 start/stop/restart`

例子：`service httpd start`（启动Apache）

### 9. kill指令

作用：表示杀死进程（当遇到僵尸进程或者出于某种原因需要关闭进程）

语法：`$kill 进程PID`（语法需要配合ps一起使用）

**killall命令**

语法：`$killall 进程名称`

### 10. ifconfig指令

作用：用于操作网卡相关指令

简单语法：`$ifconfig` （获取网卡信息）
```
eth0：表示Linux中的一个网卡，eth0是其名称
lo：loop，本地回环网卡，lo是其名称
inet addr就是网卡的ip地址
```

### 11. reboot指令

作用：重启计算机

语法1：`$reboot`

重启

语法2：`$reboot -w`

模拟重启，但是不重启（只写关机与开机的日志信息）

### 12. shutdown指令

作用：关机
**（慎用，真实服务器关机后要开机就必须跑去机房了）**

语法：`shutdown -h now “关机提示，可选”` 或者  `$shutdown -h 15:25 “关机提示”`

取消关机计划用`shutdown -c`【老版本用`Ctrl + C`】

>还有几个关机命令
>$init 0
>half
>poweroff

### 13. uptime指令

作用：输出计算机的持续在线时间（从开机到现在的运行时间）

语法：`$uptime`

【windows，cmd里输入`systeminfo`】

### 14. uname指令

作用：获取计算机操作系统相关信息

语法1：`$uname`

获取操作系统的类型

语法2：`$uname -a`

all，表示获取全部的系统信息：类型、全部主机名、内核版本、发布时间、开源计划

### 15. netstat -tnlp指令

作用：查看网络连接状态

语法：`$netstat -tnlp`

选项说明：
```
-t：表示只列出tcp协议的连接
-n：表示将地址从字母组合转化为ip地址，将协议转化为端口号来显示
-l：表示过滤出“state（状态）”列中其值为LISTEN（监听）的连接
-p：表示显示发起连接的进程pid和进程名称
```

### 16. man指令

作用：manual，手册，包含了Linux中全部命令手册

语法：`$man 命令`

退出按下q键

man.linuxde.net/

# vim

## vi介绍

vi编辑器：所有Linux和Unix系统下的标准编辑器，更适合文本编辑

vim编辑器：可以视为vi的升级版本，更适合coding

学习重点：光标的移动，模式切换，删除，查找，替换，复制，粘贴，撤销

## vim三种模式

（有的地方会更多）

### 命令模式

在该模式下不能对文件直接编辑，可以输入快捷键进行一些操作（删除行，复制行，移动光标，粘贴等等），该模式为打开文件之后默认进入的模式。

### 编辑模式（输入模式）

在该模式下可以对文件的内容进行编辑

### 末行模式（尾行模式）

可以在末行输入命令来对文件进行操作（搜索、替换、保存、退出、撤销、高亮等等）

### vim打开文件的方式：

```
$vim 文件路径
打开指定的文件

$vim +数字 文件路径
打开指定的文件，并且将光标移动到指定航

$vim +/关键词  文件的路径
打开指定的文件，并且高亮显示关键词

$vim 文件路径1 文件路径2 文件路径3
同时打开多个文件

退出方式：
:q加上回车
```

## 命令模式

### 1. 光标移动

1. 光标移动到行首

按键：`shift + 6` 或`^`（T上面的6，不要按小键盘的6）【测试一下】

2. 光标移动到行尾

按键：`shift + 4` 或`$`

3. 光标移动到首行

按键：`gg`

4. 光标移动到末行

按键：`G`

5. 翻屏

向上翻屏：

按键：`Ctrl + b`		（backward）

向下翻屏：

按键：`Ctrl + f`		（forward）

### 2. 复制操作

**粘贴：在想要粘贴的地方按下p键，和复制、剪切配合使用**

1. 复制光标所在行

按键：`yy`

2. 以光标所在行为准（包含当前行），向下复制指定的行数

按键：`数字yy`

3. 可视化复制

按键：`Ctrl + v`，然后用方向键，选中后按`yy`，`Esc`退出

### 3. 剪切/删除

1. 剪切/删除光标所在行
按键：`dd`		（删除之后下一行上移）
注意：`dd`严格上说是剪切命令，但是剪切后不粘贴就是删除的效果

2. 剪切/删除光标所在行为准（包含当前行），向下删除/剪切指定的行
按键：`数字dd`		（删除之后下一行上移）

3. 剪切/删除光标所在行，但是删除之后下一行不上移
按键：`D`		（删除之后当前行会变成空白行）

### 4. 撤销/恢复

撤销：输入:`u`（不属于命令模式）	或者 直接按`u`	（undo）
恢复：`Ctrl + r`		取消之前的撤销操作

### 5. 扩展1：光标的快速移动

1. 快速将光标移动到指定的行
按键：`数字G`
2. 以当前光标为准向上/向下移动n行
按键：`数字↑ / 数字↓`
3. 以当前光标为准向左/向右移动n字符
按键：`数字← / 数字→`
4. 末行模式下的快速移动方式：移动到指定的行
按键：英文“`:`”，其后输入行数数字，按下回车

## 模式间的切换

命令模式切换成末行模式：按下英文的冒号`:`

末行模型切换成命令模式：

1. 按1下`Esc`（会稍慢
2. 按2下`Esc`（会更快
3. 删除末行中的全部命令

命令模式切换成编辑模式：按下`i`，`a`等键

编辑模式切换成命令模式：按下`Esc`键

## 末行模式

进入方式：由命令模式进入，按下“`:`”或“`/`”（只用于查找）即可进入

退出方式
1. 按下Esc
2. 连按2次Esc键
3. 删除末行全部输入字符

### 1. 保存操作

输入：`:w`

保存文件

输入：`:w 路径`

另存为

### 2. 退出（quit）

输入：`:q`

退出文件

### 3. 保存并退出

输入：`:wq`

保存并且退出

### 4. 强制（！）

输入：`:q!`

强制退出，不保存修改

### 5. 调用外部命令

输入：`:!外部命令`

不关闭文件先调用Linux命令

### 6. 搜索/查找

输入：`/关键词`

在搜索结果中切换上/下一个结果：N/n	（next）

取消高亮：

输入：`:nohl`（no highlight）

### 7. 替换

`:s/搜索的关键词/新的内容`

替换光标所在行的第一处符合条件的内容

`:s/搜索的关键词/新的内容/g`

替换光标所在行的全部符合条件的内容

`:%s/搜索的关键词/新的内容`

替换整个文档中每行第一个符合条件的内容

`:%s/搜索的关键词/新的内容/g`

替换整个文档的符合条件的内容

`%`表示整个文件

`g`表示全局（global）

### 8. 显示行号

输入：`:set nu`（number）

取消：`set nonu`

### 9. 扩展2：使用vim同时打开多个文件，在末行模式下进行切换文件

查看当前已经打开的文件名称：`:files`
```
%a：active，表示当前正在打开的文件
#：表示上一个打开的文件
其他的为空白
```

切换文件的方式：

a. 如果需要指定切换文件的名称，则可以输入：`:open 已经打开的文件名`
b. 可以通过其他命令来切换上一个文件/下一个文件
输入：`:bn`切换到下一个文件（back next）
输入：`:bp`切换到上一个文件（back previous）

## 编辑模式

进入方式：

`i`：在光标所在字符前开始插入
`a`：在光标所在字符后开始插入（光标会往后跳一个字符）
`S`：删除光标所在行并开始插入

退出方式：

按下`Esc`键

## 使用功能

### 1. 代码着色

显示：`:syntax on`

关闭显示：`:syntax off`

### 2. vim中计算器的使用

a. 进入编辑模式

b. 按下按键`Ctrl + r`，然后输入`=`，此时光标移到末行

c. 输入需要计算的内容，按下回车，会将结果输出到光标处

# Linux自有服务

自有服务，即不需要用户独立去安装的软件服务，当系统安装好后就可以直接使用的服务。（内置）

## 1. 运行模式

运行模式也可以称之为运行级别。

在Linux中存在一个进程：init（initialize，初始化），进程id是1。

该进程存在一个对应的配置文件：inittab（系统运行级别配置文件，位置`/etc/inittab`）

通过查看配置文件，可以得知Centos6.5中存在7种运行级别/模式

>0：表示关机级别（不要将默认的运行级别设置成0）
>1：单用户模式
>2：多用户模式，不带NFS（Network File System）
>3：完全多用户模式（如果没网就和2一样了）（不带桌面的，纯命令行模式）
>4：没有被使用的模式（被保留的模式）
>5：X11，完整的图形化界面模式
>6：表示重启级别（不要讲默认的运行级别设置成这个值）

与该级别相关的几个命令：

```
$init 0
关机

$init 3
切换到不带桌面的模式

$init 5
切换到图形界面

$init 6
重启电脑
```

这些命令其实都是调用init进程，将数字（运行级别）传递给进程，进程去读配置文件执行对应的操作。

注意：init指令需要超级管理员的权限，普通用户无法执行

## 2. 用户和用户组管理

注意三个文件：
```
/etc/passwd
存储用户的关键信息

/etc/group
存储用户组的关键信息

/etc/shadow
存储用户的密码信息
```

### 1. 用户管理

#### 1. 添加用户

常用语法：`$useradd 选项 用户名`

常用选项：
```
-g：表示指定用户的用户主组，选项的值可以是用户组的id，也可以是组名
-G：表示指定用户的用户附加组，选项的值可以是用户组的id，也可以是组名
-u：uid，用户id（用户的标识符），系统默认会从500之后按顺序分配uid，如果不想使用系统分配的，可以通过该选项自定义
-c： comment，添加注释
```

验证创建用户是否成功：
a. 验证`/etc/passwd`
b. 验证是否存在家目录

>认识passwd文件
>用户名：密码：用户ID：用户组ID：注释：家目录：解释器shell
>用户名：创建的新用户名称，后期登录的时候需要输入
>密码：这里一般都是显示"x”，表示密码的占位
>用户ID：用户的识别符
>用户组ID：该用户所属的主组ID
>注释：解释该用户是做什么用的
>家目录：用户登录进入系统之后默认的位置
>解释器shell：等待用户进入系统之后，用户输入指令之后，该解释器会收集用户输入的指令，传递给内核处理

如果不添加选项的时候，直接执行`useradd 用户名`之后会执行一系列的操作
a. 创建同名的家目录
b. 创建同名的用户组

注意：查看用户的主组可以查看passwd文件，查看用户的附加组可以查看group文件

#### 2. 修改用户

常用语法：`$usermod 选项 用户名`

usermod：user modify 用户修改

常用选项：
```
-g：表示指定用户的用户主组，选项的值可以是用户组的id，也可以是组名
-G：表示指定用户的用户附加组，选项的值可以是用户组的id，也可以是组名
-u：uid，用户id（用户的标识符），系统默认会从500之后按顺序分配uid，如果不想使用系统分配的，可以通过该选项自定义
-l：修改用户名
```

#### 3. 设置密码

Linux不允许没有密码的用户登录到系统，因此直接创建的用户都处于锁定状态，需要设置密码之后才能登陆计算机

常用语法：`$passwd 用户名`

修改自己的密码可以不带用户名

#### 切换用户命令：

`$su [用户名]`

switch user

如果用户名不指定则表示切换到root用户

#### 4. 删除用户

常用语法：`$userdel 选项 用户名`

userdelete，用户删除

常用选项：
```
-r：表示删除用户的同时，删除其家目录
```

注意：已经登陆的用户需要删除的话，先kill掉用户的全部进程（直接kill最父级的进程）

### 2. 用户组管理

`/etc/group`

文件结构：
```
用户组名：密码：用户组ID：组内用户名
```
密码：x表示占位符，虽然用户组可以设置密码，但是绝大部分的情况下不设置密码

组内用户名：附加组是该组的用户名称

#### 1. 用户组添加

常用语法：`$groupadd 选项 用户组名`

常用选项：
```
-g：类似用户添加里的`-u”，-g表示选择设置一个自定义的用户组ID数字，如果不指定，则默认从500开始递增
```

#### 2. 用户组编辑

常用语法：`$groupmod 选项 用户组名`

常用选项：
```
-g：类似用户添加里的`-u”，-g表示选择设置一个自定义的用户组ID数字
-n：类似于用户修改`-l”，表示设置新的用户组的名称
```

#### 3. 用户组删除

常用语法：`$groupdel 用户组名`

注意：当如果需要删除一个组，但是这个组是某个用户的主组时，则不允许删除；如果确实需要删除，则先从组内移出所有用户

## 3. 网络设置

网卡配置文件：`/etc/sysconfig/net/network-scripts/` 目录下的 `ifcfg-eth0` 和 `ifcfglo` 等（`ifcfg-网卡名称`）
```
ONBOOT：是否开机启动
BOOTPROTO：ip地址分配方式，dhcp表示动态主机分配协议
HWADDR：硬件地址，又叫MAC地址
```

重启网卡：

有Linux部分版本可以用：

`$service network restart`

但是有一个共性的目录：`/etc/init.d` 在这个目录中放着很多服务的快捷方式

`$/etc/init.d/network restart`

扩展：如果需要创建快捷方式（软连接）

`$ln -s 原始文件的路径 快捷方式的路径`

快捷方式的文件类型：l：link

以上都会将eth0和lo均重启

扩展2：重启或者停掉单个网卡

停止某个网卡：`$ifdown 网卡名`
开启某个网卡：`$ifup 网卡名`

在实际工作的时候不要随意禁网卡。

### SSH服务

secure shell 安全外壳协议，该协议有2个常用的作用：远程连接协议、远程文件传输协议
协议使用端口号：默认是22

不建议修改，可以被修改，如果需要修改，则需要修改ssh的配置文件 /etc/ssh/ssh_config
端口号修改的注意事项：

a. 注意范围，端口范围从0-65535（2^16-1，16位二进制的最大值）
b. 不能使用别的服务已经占用的端口

服务启动/停止/重启
```
$service sshd start/stop/restart
$/etc/init.d/sshd start/stop/restart
```

#### 1. 远程终端

常见终端工具有：Xshell、secureCRT、PuTTY

1. 获取服务器ip地址，可以通过ifconfig命令进行查看，然后测试ip地址是否能ping通
2. 打开PuTTY，输入相关信息，点击open，是
3. 输入用户名和密码

#### 2. SSH服务文件传输

可视化的界面传输工具：Filezilla
1. 选择“文件” - “站点管理器”（Ctrl + s） - 新建站点 - 连接【点确定的话在界面左上角文件下面进行连接】
2. 传文件可以直接拖，或在右键点相应文件上传/下载

扩展3：通过命令行工具来传输文件/文件夹
工具：PSCP.exe（必须通过cmd命令行打开）
用法：
把PSCP.exe放到环境变量里后，直接在cmd里输入pscp回车，就可以列出用法和选项
a. pscp 选项 用户名@Linux主机地址：资源路径 Windows本地的地址	（下载到win）
b. pscp 选项 资源路径 用户名@Linux主机地址：远程路径	（上传到Linux）
c. pscp 选项 -ls 用户名@Linux主机地址	（列出远程路径下结构）
【传文件夹-r】

## 1. 设置主机名

严格讲不算服务，只是一个操作
回顾：查看
```
$hostname
$hostname -f	FQDN（全限定域名）
```

### 1. 临时设置主机名，需要切换用户使之生效（su）或重启终端

`$hostname 设置的主机名`

### 2. 永久设置主机名（需要重启）

主机名的配置文件：`/etc/sysconfig/network`

此时直接ping主机名并不能ping通，需要修改hosts文件设置FQDN

### 3. 修改Linux服务器的hosts文件，将主机名指向本地（设置FQDN）

Host位置：`/etc/hosts`
加上对应的主机名

不设置FQDN的后果：
1. 很多开源服务器软件（例如Apache）无法启动，或出现报错
2. 方便记忆，看到主机名对其作用有一个初步的判断
3. 如果不设置则会影响本地的域名的解析（本地访问）

即需要保证`hostname -f`的输出结果正确

## 2. chkconfig

作用：开机启动向的管理服务
`check config`
1. 开机启动服务查询
    `$chkconfig --list`

2. 删除服务
    `$chkconfig --del 服务名`

3. 添加开机启动服务
    `$chkconfig --add 服务名`
    并不是所有软件都有服务名，必须保证服务正常运行才可以添加

4. 设置服务在某个级别下开机启动/不启动
    `$chkconfig --level 启动级别 服务名 on/off`
    启动级别用连在一起的数字

## 3. ntp服务

作用：ntp主要是用于对计算机的时间同步管理操作。

同步服务器时间方式有2个：一次性同步（手动同步）、通过服务自动同步

1. 一次性同步时间

`$ntpdate 时间服务器的域名或ip地址`

ip地址百度既可以

2. 设置时间同步服务

服务名：ntpd

启动ntpd服务：

`$service ntpd start`  或者  `/etc/init.d/ntpd start`

设置ntpd服务开机启动
```
$chkconfig --list | grep ntpd
$chkconfig --level 35 ntpd on
```

## 4. 防火墙服务

防火墙：防范一些网络攻击。有软件防火墙、硬件防火墙。

选择性让请求通过，从而保证网络安全。

在centos6.5中防火墙名称为iptables，7.x中是firewalld

1. iptables服务的启动/关闭/重启
```
$service iptables start/stop/restart
$/etc/init.d/iptables start/stop/restart
```
2. 查看iptables的状态（规则信息）
```
$service iptables status
```
3. 查看规则命令
```
$iptables -L [-n]
-L：列出规则
-n：将单词转换为数字形式显示
```
4. 简单设置防火墙规则
规则用的时候百度就行
```
$iptables -A INPUT -p tcp --dport 80 -j ACCEPT	#允许访问80端口
```
>iptables：主命令
>-A：add，添加规则
>-I：和-A差不多，表示将规则添加在最前面
>INPUT：进站请求
>-p：protocol，指定协议
>--dport：指定端口号
>-j：指定行为结果，允许（accept）/禁止（reject）

添加完之后需要保存：
```
$ /etc/init.d/iptables save
```

## 5. rpm管理

作用：对Linux上的软件包进行对应的管理操作，查询、卸载、安装

1. 查询

`$rpm -qa | grep 关键词`
选项：
```
-q：查询，query
-a：全部，all
```

2. 卸载

`$rpm -e 软件的名称`
有的软件卸载的时候有依赖关系，会提示无法卸载
`$rpm -e 软件包名 --nodeps`
忽略依赖关系，直接卸载

3. 软件的安装
软件包的获得方式：
a. 官网下载
b. 光盘（镜像iso）/media/...（挂载点名称）
以光盘为例，查看块状设备的信息
$lsblk
查看块状设备的信息
NAME：名称
SIZE：设备大小
TYPE：类型
MOUNTPOINT：挂载点

扩展：光盘的挂载和解挂
a. 解挂操作
命令：umount
语法：$umount 当前设备的挂载点（路径）
b. 挂载光盘
命令：mount
语法：$mount 设备原始地址 要挂载的位置路径
设备原始地址：/dev/name值（lsblk查看，根据大小确定）
一般都挂载在/mnt下

安装软件的命令：
$rpm -ivh 软件包完整名称
选项：
-i：install，安装
-v：显示进度条
-h：表示以“#”显示进度条

更新：
$rpm -Uvh 完整名称

查询指定文件属于哪个包
$rpm -qf 文件路径

## 6. cron/crontab计划任务

语法：$crontab 选项
常用选项：
-l：list，列出指定用户的计划任务列表
-e：edit，编辑指定用户的计划任务列表
-u：user，指定的用户名，如果不指定，则表示当前用户
-r：remove，删除指定用户的计划任务列表

编辑计划任务：
>计划任务的语法规则格式，以行位单位，一行则为一个计划：
>分 时 日 月 周 需要执行的命令

例如，每天0点0分指定reboot命令
0 0 * * * reboot

取值范围：
分：0-59
时：0-23
日：1-31
月：1-12
周：0-6,0表示星期天

四个符号：

\*：表示取值范围中的每一个数字
\-：做连续区间表达式，如1-7
/：表示每多少个，如每10分钟一次，在分的位置写 \*/10
，：表示多个取值，如1,2,6

":wq“和“:x”一样，保存退出

crontab权限问题：默认任何用户都可以创建自己的计划任务
超级管理员可以通过配置设置某些用户不允许设置计划任务：
配置文件（黑名单）：/etc/cron.deny
写法：写用户名，一行一个
还有一个配置文件（白名单）：/etc/cron.allow【该文件不存在，需要自己创建】

白名单的优先级高于黑名单，如果一个用户同时存在两个名单中，则会允许创建计划任务。

# Linux 的权限管理操作

Linux权限操作与用户、用户组是兄弟操作。

## 1. 权限概述

总述：Linux系统一般将文件可存取访问的身份分为3个类别：owner、group、others，且3种身份各有read、write、execute等权限。

### 1. 权限介绍

在Linux中分别有读、写、执行权限：
读权限：
对于文件夹来说，读权限影响用户是否能列出目录结构
对于文件来说，读权限影响用户是否可以查看文件内容

写权限：
对于文件夹来说，写权限影响用户是否可以在文件夹下“创建/删除/复制到/移动到”文档
对于文件来说，写权限影响用户是否可以编辑文件内容

执行权限：
一般都是对文件来说，特别脚本文件

### 2. 身份介绍

owner身份（文件所有者，默认为文档的创建者）
group身份（与文件所有者同组的）
others身份（其他人，相对于所有者）

root用户（超级用户，拥有最大的权限，管理者所有普通用户）
### 3. Linux的权限介绍
查看文件权限：
$ls -l 路径【等价于$ll】
如：
drwr-x---
r：read，可读
w：write，可写
x：execute，可执行
十位字符的表示含义：
第1位：表示文档类型，取值常见的有“d表示文件夹”、“-表示文件”、“l表示软连接”、“s表示套接字”等等
第2-4位：表示文档所有者的权限情况，第2位表示读权限的情况，取值有r、-；第3位表示写权限的情况，w表示可写，-表示不可写，第4位表示执行权限的情况，取值有x、-
第5-7位：表示与所有者同在一个组的用户的权限情况
第8-10位：表示除了上面的前2部分的用户之外的其他用户的权限情况

权限分配中，均是rwx三个参数组合，且位置顺序不会变化，没有对应权限就用-代替
## 2. 权限设置
语法：$chmod 选项 权限模式 文档
注意事项：
常用选项：
-R：递归设置权限（当文档类型为文件夹的时候）
权限模式：该文档需要设置的权限信息
注意：如果想要给一个文档设置权限，操作者要么是root用户，要么就是文档的所有者。
### 1. 字母形式
选项|字母|介绍
---|---|---
（谁）|u|用户
（谁）|g|所属群体
（谁）|o|其他人
（谁）|a|所有人（“全部”）
（作用）|+|增加权限
（作用）|-|减少权限
（作用）|=|确定权限
（权限）|r|可读
（权限）|w|可写
（权限）|x|执行

给谁设置：
u：表示所有者身份owner(user)
g：表示给所有者同组用户设置（group）
o：表示others，给其他用户设置权限
a：表示all卖给所有人（包含ugo部分）设置权限
**如果在设置权限的时候不指定给谁设置，则默认给所有用户设置**
权限字符：
r：读
w：写
x：表示执行
权限分配方式：
+：表示给具体的用户新增权限（相对当前）
-：表示删除用户权限（相对当前）
=：表示将权限设置成具体的值（注重结果）

如：给a文件（-rw-------）设置权限，所有者拥有全部权限，同组用户拥有读和执行权限，其他用户只读权限
$chmod u+x,g+rx,o+r a
$chmod u=rwx,g=rx,o=r a
### 2. 数字形式
没有任何权限：0
读：r		4
写：w		2
执行：x	1
数值|权限|目录列表|计算
---|---|---|---
0|不能读，不能写，不能执行|---|0
1|不能读，不能写，可执行|--x|1
2|不能读，可写，不能执行|-w-|2
3|不能读，可写，可执行|-wx+|2+1
4|可读，不能写，不能执行|r--|4
5|可读，不能写，可执行|r-x|4+1
6|可读，可写，不能执行|rw-|4+2
7|可读，可写，可执行|rwx|4+2+1

例：给a文件设置权限，所有者拥有全部权限，同组用户拥有读和执行权限，其他用户只读权限
$chmod 754 a
【当一个命令有2、3，该权限可写不可读，不合理，在这种情况下输出重定向可以写进去，但是其他的不行】
### 3. 注意事项
在Linux中，如果要删一个文件，要看对该目录是否有写权限。
## 3. 属主与属组设置
属主：所属的用户（文件的主人）
属组：所属的用户组
$ls -l中的第3、4列
这两项信息在文档创建的时候会使用创建者的信息（用户名、用户所属的主组名称）
如果有时候去删除某个用户，则该用户对应的文档的属主和属组信息就需要去修改。
### 1. chown
change owner
作用：更改文档的所属用户
语法：$chown [-R] username 文档路径
-R：递归
### 2. chgrp
grp：group
作用：更改文档的所属用户组
语法：$chgrp [-R] groupname 文档的路径
### 一个命令既更改所属的用户，也修改所属的用户组
$chown [-R] username:groupname 文档路径
## 4. 扩展
sudo（switch user do）
sudu可以让管理员（root）事先定义某些特殊命令谁可以执行
默认sudo中是没有除root之外用户的规则，想使用则先配置sudo
配置文件：/etc/sudoers
a. 修改该文件用命令"$visudo"
b. 配置普通用户的权限
root ALL=(ALL) ALL
root：表示用户名，如果是用户组，则可以写成“%组名”
ALL：表示允许登录的主机（地址白名单）
（ALL）：表示以谁的身份执行，ALL表示root身份
ALL：表示当前用户可以执行的命令，多个命令可以使用","分割

**注意，在写sudo规则的时候不建议写直接形式的命令，而是写命令的完整路径
路径可以使用which命令来查看
语法：$which 指令名称**

**终端复制与粘贴：
1. ctrl+shift+c，ctrl+shift+v
2. 左键选中即复制，单机滚轮粘贴**

如：使test用户可以添加用户并且修改密码（但是不能修改root用户密码）
test ALL=（ALL） /usr/sbin/useradd,/usr/bin/passwd,!/usr/bin/passwd root
【测试一下，不行的话娿在第一个passwd后面加上 [A-Za-z]\*
查看自己有哪些特殊权限：
$sudo -l

sudo不是所有Linux分支都有的命令
# Linux的网络基础

## 1. 网络相关概述
### ip地址
私有地址，非注册地址
A类 10.0.0.0--10.255.255.255
B类 172.16.0.0--172.31.255.255
C类 192.168.0.0--192.168.255.255

公有地址也可以分三类：
类别|最大网络数|IP地址范围|最大主机数|私有IP地址范围
---|---|---|---|---
A|126（2^7-2）|1.0.0.0-127.255.255.255|16777214|10.0.0.0--10.255.255.255
B|16384（2^14）|128.0.0.0-191.255.255.255|65534|172.16.0.0--172.31.255.255
C|2097152（2^21）|192.0.0.0-223.255.255.255|254|192.168.0.0--192.168.255.255
## 2. 网络相关命令
### 1. ping
作用：检测当前主机与目标主机之间的连通性（不是100%准确，有的服务器是禁ping 的）
语法：$ping 目标主机地址（ip地址、主机名、域名等）
Linux下默认一直发送；Windows默认发送4个，想一直发加-t
### 2. netstat
作用：表示查看网络的连接信息
语法：
$netstat -tnlp（-t：tcp协议；-n：将字母转化为数字；-l：列出状态为监听；-p：显示进程相关信息）
$netstat -an（-a：表示全部；-n：将字母转化为数字）
### 3. traceroute
作用：查找当前主机与目标主机之间所有的网关（路由器，会给沿途各个路由器发送icmp数据报，路由器可能会不响应）
该命令不是内置命令，需要安装。
语法：traceroute 主机地址
Windows下命令为：tracert

tools.chinaz.com 有很多在线网络工具
### 4. arp
地址解析协议（Address Resolution Protocol），是根据IP地址获取物理地址（MAC）的协议
一个主机发送数据的时候，先查看本地MAC地址缓存中是否有目标主机的MAC地址，有就用，没有就发送广播包，拥有该IP的主机会发出回应发送MAC地址回来，如果本地子网中没有该主机，ARP解析到的MAC地址是默认网关的MAC地址。
常用语法：
$arp -a
查看本地缓存MAC表【此命令在Windows下一样】
$arp -d 主机地址
删除指定的缓存记录
### 5. tcpdump（了解）因为一般用别的东西Charles
作用：抓包，抓取数据包
常用语法：
$tcpdump [协议] port 端口
$tcpdump 协议 port 端口 host 地址
$tcpdump -i 网卡设备吗
## 3. 项目上线流程
1. 服务器选配购买
2. 域名购买
3. 域名备案【在阿里云控制台界面上就有
4. 域名解析
5. 配置生产环境
6. 上传代码
# shell基础
## 1. 关于shell
常见脚本：JavaScript（前端）、JSP、PHP（后端）、Shell
常见的shell有很多
nologin
/sbin/nologin指用户不能登录
【$usermod -s /sbin/nologin 用户名
用户不能登录】
bash
/bin/bash
直接输入help可以查看帮助
## 2. shell入门
编写规范：
代码规范
    #!/bin/bash
    #告诉系统，指定当前这个脚本要用的shell解释器
    shell相关指令
文件命名规范：
文件名.sh

使用流程：
1. 创建.sh文件
2. 编写shell代码
3. 执行shell脚本【脚本必须得有执行权限】

输出命令：
echo 文本
注意：输出的内容如果包含字母和符号（不包含变量），需要用引号包括起来，如果是纯数字可包可不包

结尾的分号可加可不加，推荐不加

脚本执行的另一个方式：
/bin/bash 脚本路径
/bin/sh 脚本路径【/bin/sh现在是/bin/bash的一个快捷方式】

shell分为简单的写法（简单的命令的堆积）和复杂写法（程序的设计）
## 2. shell进阶
### 1. 变量
#### 1.1 变量的含义
#### 1.2 变量的定义与使用
定义：class_name="yunwei"
使用：echo $class_name

在使用变量的时候在变量名前添加$符号，php也是这样的

**注意：变量名后面的等号左右不能有空格！！！**

**关于单双引号：
双引号能够识别变量，双引号能够实现转义
单引号不能识别变量，只会原样输出，单引号是不能转义的**

**反引号：·
当在脚本中需要执行一些指令并且将执行的结果赋给变量的时候需要使用反引号**
#### 1.3 只读变量
语法：readonly 变量名
#### 1.4 接受用户输入
语法：read -p 提示信息 变量名
#### 1.5 删除变量
语法：unset 变量名
### 2.条件判断语句
语法：
    if condition
    then
        command1
        command2
    elif condition2
    then
        command3
    else
        command4
    fi
单行写法：if[ condition ];then command;fi
## 3. 运算符
### 3.1 算术运算符
原生bash不支持简单的数学运算，但是可以通过其他命令来实现，如awk和expr
expr最常用，是一款表达式计算工具，例如：
	#!/bin/bash
	val=`expr 2 + 2`
**注意！！！**
**表达式与运算符中间必须要有空格，2+2不行，必须是 2 + 2**
*在表达式中需要转义才能是乘法
例如：·expr $a \* $b·
运算符|说明
---|---
+|加
-|减
*|乘，在表达式中得写成\*
/|除
%|取余
=|赋值
==|相等
！=|不等
**条件表达式要放在方括号里，并且必须有空格，如[ $a == $b ]**
### 3.2 关系运算符
关系运算符只支持数字，不支持字符串，除非字符串的值是数字
运算符|说明|
---|---|---
-eq|检测两个数字是否相等|equal，即==
-ne|检测两个数是否不相等|not equal，即！=
-gt|检测左边的数是否大于右边的|great than
-lt|检测左边的数是否小于右边的|less than
-ge|检测左边的数是否大于等于右边的|great than or equal
-le|检测左边的数是否小于等于右边的|less than or equal
如果是返回true
### 3.3 逻辑运算符
运算符|说明
！|非
-o|或
-a|与
取反的！后吗可以不用空格
### 3.4 字符串运算符
运算符|说明|举例
=|检测两个字符串是否相等|[ $a = $b ]
！=|检测两个字符串是否不等
-z|检测字符串的长度是否为0
-n|与-z相反，判断字符串长度是否不为0
str|检测字符串是否为空，不为空返回true|[ $a ]
### 3.5 文件测试运算符
文件测试运算符用于检测Unix/Linux文件的的各种属性
操作符|说明
-b file（文件路径）|检测文件是否是块设备文件
-c file|检测文件是否是字符设备文件（几乎不用）
-d file|检测文件是否是目录【常用】
-f file|检测文件是否是普通文件（既不是目录也不是设备文件）【常用】
-r file|检测文件是否可读【常用】
-w file|检测文件是否可写【常用】
-x file|检测文件是否可执行【常用】
-s file |检测文件是否为空（文件大小是否大于0）【较常用】
-e file|检测文件（包括目录）是否存在【常用】

【-r-w-x只要有一个部分符合就认为是有权限的】
## 4. shell脚本附带选项
参数传递：
$./test.sh a b c
接收：
在脚本中用“$1”来表示a，“$2”来表示b，以此类推。“$0”为“./test.sh”

别名：~/.bashrc【自己再查一下
# shell

## shell变量

### 定义变量

等号两边不能有空格，第二次赋值也是一样的，不加$

### 使用一个定义过的变量

前面加$
变量名外可以加{}来括起来

### 只读变量

readonly声明一下

### 删除变量

unset

### 获取字符串长度

    string="abcd"
    echo ${#string}

### 提取子字符串

    echo ${string:1:4}

提取从第2个字符开始的4个字符

### 查找子字符串

    echo `expr index "$string" io`

## shell数组

只能有1维数组，大小无限

### 定义数组

圆括号括起来，空格隔开；或者array[0]=value这样一个个赋值

### 读取数组

${array[0]}
0换成@表示获取全部元素

### 获取数组长度

    length=${#array[@]}   #或者将@换为*

## 多行注释

    :<<!
    1
    2
    3
    !

！可以换成EOF或''

## 传参

$n
$# 传进来参数的个数
$* 以一个单字符串显示所有参数，参数用空格隔开
$$ 当前进程ID
$! 后台运行的最后一个进程的ID
$@ 所有传进来的参数，但是每个参数都会用引号隔开
$- 显示shell使用的当前选项
$? 显示命令的退出状态，0表示没有错误

# MySQL基础

## 1. 关于数据库
### 1. 什么是数据库
如果一个项目是动态内容的话（内容会变化的，网页后缀.jsp、.php、.shtml,静态的.html、.htm），则数据库是必不可少的一个环节。
### 2. MySQL简介
关系型数据库管理系统
在WEB应用方面，MySQL是最好的RDBMS（Relational Database Management System，关系数据库管理系统）应用软件，和php是黄金搭档（LAMP/LNMP：Linux Apache Nigix/MySQL php）
### 3. 常见的其他数据库软件
Oracle（重量级的数据库）、MS SQL Server（微软的）、Access（微软）、PostgreSQL、DB2、Mariadb（MySQL分支，完全兼容MySQL）
## 2. MySQL的安装与初始化
操作之前确保计算机时间准确：
### 1. Linux下的软件安装方式
#### 1. 源码包
优点：开源，可以修改；编译安装，稳定高效
缺点：安装步骤多，容易出错；编译时间过长
>扩展：解包
>常用语法：
>    $tar -zxvf *.tar.gz【记忆：北京j b，广州z g】
>    $tar -jxvf *tar.bz2
>选项含义：
>-z或-gzip或--ungzip：通过gzip指定处理文件
>-x或--extract或--get：从文件中还原文件
>-v：显示操作过程
>-f或--file：制定一个文件
>-j：支持bzip2解压文件

源码包安装过程：
1. 解压，切换到源码文件：
2. 配置（config/configure/bootstrap），指定软件的安装目录、需要的依赖在什么地方、指定不需要可选依赖、配置文件的路径、通用数据存储位置等等
指定软件的安装路径：--prefix=路径   【一般装在/usr/local/软件】
需要依赖的路径：--with-PACKAGE 包名=包所在的路径
不需要依赖：--without-PACKAGE 包名

3. 编译（make/bootstrapd）
4. 安装（make install/bootstrapd install）
#### 2. 二进制包（rpm）
优点：安装简单
缺点：看不到源码
#### 3. yum等傻瓜式安装【Ubuntu下是apt】
优点：安装简单快捷
缺点：完全丧失了自定义性
注意：如果不更改软件来源，需要联网才能适用
>**常用的yum指令：**
>    $yum list【列出当前已经装的和可以装的软件（全部）】
>    $yum search 名【搜索指定的关键词的包
>    $yum [-y] install 包名【安装指定的包，-y：整个安装过程中均允许不需要确认】
>    $yum [-y] update [包名]【更新指定的包，不指定包则更新全部软件】
>    $yum [-y] remove 包名【卸载指定的包，别随便用-y，可能会卸载掉很多东西】

### 2. 安装MySQL
以yum安装为例
#### 2.1 MySQL安装
$yum install mysql-server
#### 2.2 MySQL初始化
先启动再配置：
$service mysqld start
$mysql_secure_installation【mysql_se按tab，出现2个找】
会提示输入当前root用户的密码，如果没有按回车，注意此root不是Linux的root用户，是MySQL的
提示是否移除匿名用户：是，为了安全
不允许root远程登录？：没用，都不允许
是否移除测试数据库？随便
重新加载权限表？（当更改了MySQL用户相关信息后建议去重载权限）

$netstat -tnlp查看MySQL端口号
默认端口号：3306
#### 2.3 MySQL的启动控制
语法：$service mysqld start/stop/restart
进入MySQL的方式：
$mysql -u 用户名 -p[密码]
退出：exit
#### 2.4 默认目录/文件位置
数据库存储目录：/var/lib/mysql
配置文件：/etc/my.cnf

## 3. MySQL的基本操作

### 1. 名词介绍
以Excel文件举例：
数据库：可以看做是整个Excel文件
数据表：可以看作是一个Excel文件中的工作表
行（记录）：可以看作工作表中的一行
列（字段）：可以看作工作表中的一列
### 2. 库操作
以下命令在MySQL终端命令行中执行：【MySQL命令不区分大小写，都可以，注意大部分命令都要加分号】
SHOW DATABASES；
显示当前MySQL中全部的数据库
create database 库名;
创建数据库
drop database 库名;
删除数据库
use 库名;
切换数据库
### 3. 表操作
show tables
显示当前数据库中的所有表明（必须先use数据库）

create table 表名称
(
列名称1 数据类型 [NOT NULL AUTO_INCREMENT]，         #非空，自动递增，常用序号
列名称2 数据类型，
......
PRIMARY KEY（主键字段名）
)；
在当前数据库下创建数据表
常见数据类型有：int（整型）、char（定长字符）、varchar（不定长字符）、
主键一般就是序号所在的那一列（主键不能重复）

DESC 表明；
查看表结构

DROP TABLE [IF EXISTS] 表名；
删除数据表

例：

	create table xg
	
	(
	
	   id int(11) not null auto_increment,
	
	   username varchar(20),
	
	   password char(32),
	
	   primary key(id)
	
	);

### 4. 记录/字段操作
#### 4.1 增加记录
加行数
语法1：INSERT INTO 表名称 VALUES（值1，值2，...）；
语法2：INSERT INTO 表名称（列1，列2，...） VALUES（值1，值2，...）；
案例：
往数据表xg中新增一个记录username为zhangsan，password为123456
SQL语句：
insert into xg (username,password) values ('zhangsan',123456);
【1.字段可以加反引号，也可以不加 2.字符必须加引号】
#### 4.2 更新记录
UPDATE 表名称 SET 列名称1 = 新值1，列名称2 = 新值2 ... WHERE 列名称 = 某值；
条件要注意，如果不写全部更新，写错漏写非常麻烦
#### 4.3 查询记录
SELECT 列名称1，列名称2 FROM 表名称 WHERE 条件；
查询指定列
SELECT * FROM 表名称 WHERE 条件；
查询全部列
#### 4.4 删除记录
DELETE FROM 表名称 WHERE 列名称 = 值；
### 5. 备份与还原
#### 5.1 备份
全量备份（数据+结构）：$mysqldump -uroot -p123456 -A > 备份文件路径【在Linux里写，-p后面直接写明文密码，-A全部数据库】
指定库备份（数据+结构）：$mysqldump -uroot -p123456 库名 > 备份文件路径
多个库备份（数据+结构）：$mysqldump -uroot -p123456 --databases db1 db2 > 备份文件路径xxx.sql【或者在>后加上tar，压缩成tar.gz】
#### 5.2 还原
还原分2种方法：一种是MySQL命令行的source方法，另一种是系统命令行的方法
1. 还原全部数据库：
MySQL命令行：mysql> source 备份文件路径【建议用这个】
系统命令行：$mysql -uroot -p123456 < 备份文件路径 【<输入重定向】
2. 还原单个数据库：
mysql> use 库名
mysql> source 备份文件路径

设置MySQL连接字符集：
mysql> set names utf-8

## 4. 扩展
### 1. MySQL的远程管理工具
分为两大类：B/S架构、C/S架构
B：浏览器；S：服务器
C：客户端；S：服务器
在B/S中：PMA（phpMyAdmin）
在C/S中：Navicat、MySQL workbranch
允许MySQL远程登录：
先进入数据库选择MySQL数据库，然后执行select host,user from user;，修改主机名的那个（FQDN）的host值为%（update user set host = '%' where host = 'yunwei';），刷新权限表或者重启MySQL（flush privileges;)

# Yum项目上线实战
## 1. 编译安装和卸载Nginx
### 1. 安装Nginx
a.下载Nginx
$wget 地址
先切换到目的地址
b.解压
$tar -zxvf ...
c.进入解压目录
开始配置、编译、执行
$./configure --prefix=路径
在配置的时候报错，没有PCRE库，直接$yum install pcre-devel（devel：开发版本）
$./configure --prefix=路径 --with-pcre
又报错，缺少zlib，$yum install zlib-devel
还需要下载zlib的源码包，并解压
$./configure --prefix=路径 --with-pcre --with-zlib=指向源码包
开始安装：
$make
$make install

启动Nginx：
先关Apache：$service httpd stop
$/usr/local/nginx/sbin/nginx
重启：
$/usr/local/nginx/sbin/nginx -s reload【重载，重载配置文件】
【因为是源码编译的】
## 2. 关于LAMP
Linux + Apache + MySQL + PHP

LAMP架构（组合）

## 3. LAMP环境部署
快照一下
### 1. PHP和Apache的安装
先装php，Apache会作为php的依赖自动安装：
$yum install php
会有警告，无法确定主机的FQDN，如果需要处理，修改Apache的配置文件（/etc/httpd/conf/httpd.conf）
搜索ServiceName，将前面的#去除，保存
然后重启Apache
测试访问，在地址栏输入ip（关闭防火墙）
测试php是否可以运行（默认Apache站点目录：/var/www/html）
在里面创建index.php（首页）:
	<?php
	phpinfo();

### 2. MySQL的安装与初始化
$yum install mysql-server
启动，初始化：
$service mysqld start
$mysql_secure_installation
测试命令行登录：
$mysql -uroot -p
修改远程登录主机：
update user set host = '%' where host = '127.0.0.1';
重启MySQL或刷新权限
mysql>flush privileges;
### 3. 项目上线
解压项目包，将uploa内容上传到服务器站点目录（/var/www/html)


# 黑马
CRT 远程连接软件

/根目录
~家目录
root的家目录/root

ls -a显示所有，包括隐藏文件
ls -l显示详细信息，简写ll

cd -返回上一次所在的目录

mkdir和rmdir【删不了非空文件夹，用的不多】
mkdir -p多级目录

cat/more【回车一行，空格一屏幕，q退出】/less【比more多一个上下箭头翻动】
tail -f 文件【动态查看，常用于查看日志变化】

rm删除文件
rm -r 删除文件夹
rm -f 不询问是否删除
一起用 rm -rf
rm -rf /* 删除root下所有文件，自杀

tar -cvf 打包      .tar
tar -zcvf 压缩     .tar.gz
-x解压
-c打包
-v显示过程信息
-f指定文件

-C 指定解压到的文件夹


find

grep xxx file --color -A1 -B1
--color 高亮xxx  A1：除了匹配行，还显示后面的1行 B前面 After Before


vim内：
底行模式
/8080 搜索8080


ps -ef查看进程
kill -9 pid 强制杀死-9


网络操作
hostname查看主机名
hostname xxx修改主机名【暂时的，永久改/etc/sysconfig/network】

ifconfig看ip改ip【永久/etc/sysconfig/network-scripts/ifcfg-eth0】
service network restart重启网络服务
防火墙service iptables start/stop/restart/status

域名映射
/etc/hosts

Linux安装软件
RPM包：红帽，但是不安装依赖
yum：RPM规范打包好的，在线安装，会下依赖

FTP客户端工具：
FileZilla
lrzsz【感觉依托于CRT？】rz和sz
sftp【感觉还是依托于CRT】put和get



查看Linux系统的位数【32/64】
getconf LONG_BIT

java安装：
删除原来的：
查看当前安装的：rpm -qa | grep java【rpm是红帽的包管理】
卸载rpm -e --nodeps 后面跟上面那个命令的输出

JDK的环境变量：
JAVA_HOME
CLASSPATH=.:$JAVA_HOME/lib.tools.jar
PATH=$JAVAHOME/bin:$PATH
export JAVA_HOME CLASSPATH PATH

MySQL安装：
查看当前安装的：rpm -qa | grep java
卸载rpm -e --nodeps 后面跟上面那个命令的输出
安装服务端
rpm -ivh xxxserver
会随机生成一个密码在日志里给出路径
安装客户端
rpm -ivh xxxclient

service mysql start

随机密码登录后设置密码
set password = password('密码');

开放远程访问权限
grant all privileges on *.* to 'root' @'%' identified by '密码';
flush privileges;刷新

后面还要打开防火墙3306

redis安装：
先下gcc-c++
下载redis
解压，编译make
然后安装：make install
然后要找一下config文件，在原来解压的文件夹里，编译好的地方没有


部署项目

打war包：build标签里面可以指定filename标签，指定war包的名称

记得导数据库【本地导出，服务器导入】

druid.properties里
url后面要加上字符集characterEncoding=utf-8

然后把war包扔到webapps里
