https://stackoverflow.com/questions/50239658/higher-cardinality-column-first-in-an-index-when-involving-a-range

https://stackoverflow.com/questions/12315496/which-column-to-put-first-in-index-higher-or-lower-cardinality

# 大纲

1. 引子：索引是什么、作用以及重要性   2分钟以内
2. 索引的主要分类以及原理    5分钟
3. 覆盖索引和聚簇索引     5分钟
4. 如何创建索引以及IN小技巧等   10分钟

# 内容文稿

## 第一节 索引基础

索引（index），在MySQL中也叫做“键”（key），是存储引擎用于快速找到记录的一种数据结构。

索引对于数据库查询操作的性能提高非常有效，一个好的索引可以轻易将查询性能提高几个数量级。

## 1.1 索引分类

MySQL中的索引是在存储引擎层实现的，不同的存储引擎使用不同类型的索引。

### 1 B-Tree索引

大多数引擎支持的索引类型，是InnoDB默认的索引类型，实际上使用的是B+树，不过在MySQL的语句中都是用B-Tree一词作为关键字。



这里可以简单介绍一下B+树



B+树的优点：

1. 树的高度会低一点
2. 叶子层的链表便于区间遍历



最左前缀法则

适用的查询类型

下面有



一些细节，MyISAM和InnoDB的区别



### 2 哈希索引

只有Memory引擎显式的支持

但是InnoDB有功能 自适应哈希索引



小技巧：自定义哈希索引

这里还有好多东西



### 3 其他的一些索引类别

空间数据索引

全文索引

其他索引类别



## 索引优点原因分析，与总结部分



## 如何选择和使用索引











# 高性能MySQL

## 1 创建高性能的索引

+ 索引 key的基本概念

  

  ## 索引的类型

+ B-tree

+ MyISAM，前缀压缩技术，使用数据的物理位置引用

+ InnoDB，使用原数据格式，根据主键引用



索引对多个值进行排序的顺序

索引树节点有序



索引对哪些查找有效：

+ 全值匹配
+ 匹配最左前缀
+ 匹配列前缀
+ 匹配范围值
+ 精确匹配某一列并范围匹配另一列
+ 只访问索引的查询：覆盖索引

索引还可以适用于排序



限制：

+ 不是按照最左列开始查找，则无法使用索引
+ 不能跳过索引中的列
+ 如果有个列用了范围查询，那么其右边的所有列都无法使用索引优化查找

在优化性能的时候，，可能需要使用相同的列但顺序不同的索引来满足不同类型的查询需求





### 哈希索引

只有精确匹配索引所有列查询才会用

只有memory引擎显式支持哈希索引，跟java里的hashmap一样，哈希冲突就用一个链表保存

【memory也支持btree索引】

+ 哈希索引只包含哈希值和行指针，不能用索引中的值来避免读取航，不过访问内存中的行的速度很快，这一点影响不明显
+ 不能用于排序
+ 不支持部分索引列的查找
+ 只支持等值查询
+ 冲突的时候会减慢速度
+ 冲突很多的时候，删减的时候代价很大



InnoDB有个特殊功能叫做  自适应哈希索引

adaptive hash index

当InnoDB注意到某些索引值被使用的非常频繁时候，它会在内存中给予B-Tree索引之上再创建一个哈希索引

用户无法控制或配置，但是可以关闭




创建自定义哈希索引，伪哈希索引

自己写个列，自定义一个索引  P148

其他索引：R-Tree、全文索引 P299、分形树索引



## 索引的优点

## 高性能的索引策略

### 独立的列

### 前缀索引和索引选择性

### 多列选择

选择合适的索引列顺序

聚簇索引

覆盖索引

使用索引扫描来做排序

压缩索引

冗余和重复的索引

未使用的索引

索引和锁

支持多种过滤条件

避免多个范围条件

优化排序



总结





